<project name="jPOS-EE-SDK-eecore3" basedir="../..">
 <property file="build.properties"/>
 <property name="module.name" value="eecore3" />
 <property name="dist.dir"    value="dist"/>
 <property name="build.dir"   value="build"/>
 <property name="modules.dir" value="modules"/>
 <property name="build.src"   value="${build.dir}/src"/>
 <property name="build.lib"   value="${build.dir}/lib"/>
 <property name="build.cfg"   value="${build.dir}/cfg"/>
 <property name="classes.dir"   value="${build.dir}/classes"/>
 <property name="module.src.dir" value="${modules.dir}/${module.name}/src"/>
 <property name="module.lib.dir" value="${modules.dir}/${module.name}/lib"/>
 <property name="module.cfg.dir" value="${modules.dir}/${module.name}/cfg"/>
 <property name="jpos.home" value="http://jpos.org/ee" />

 <path id="main.classpath">
  <fileset dir="${build.lib}">
   <include name="*.jar"/>
  </fileset>
  <pathelement location="${classes.dir}"/>
 </path>

 <target name="prepare">
  <filter filtersfile="${target}.properties" />
  <concat destfile="${build.src}/org/jpos/ee/Constants.tmp" append="false" force="true">
   <header filtering="no" trimleading="yes"><![CDATA[package org.jpos.ee;
       public interface Constants {]]>
   </header>
   <filterchain>
     <expandproperties/>
   </filterchain>
   <path>
     <fileset dir="${modules.dir}" excludesfile="${modules.ignore.list}">
      <include name="**/*.k"/>
     </fileset>
   </path>
   <footer filtering="no" trimleading="yes">}</footer>
   <string value="" />
  </concat>
  <copy file="${build.src}/org/jpos/ee/Constants.tmp"
      tofile="${build.src}/org/jpos/ee/Constants.java"
      filtering="true" />
  <delete file="${build.src}/org/jpos/ee/Constants.tmp" />

  <!-- Do the same with .p files, in order to create Constants.properties -->
  <concat destfile="${build.src}/org/jpos/ee/Constants.tmp" append="false" force="true">
   <header filtering="no" trimleading="yes"><![CDATA[#
       # Autogenerated by jPOS-EE - do not edit
       #
   ]]></header>
   <filterchain>
     <expandproperties/>
   </filterchain>
   <path>
     <fileset dir="${modules.dir}" excludesfile="${modules.ignore.list}">
      <include name="**/*.p"/>
     </fileset>
   </path>
   <string value="" />
  </concat>
  <copy file="${build.src}/org/jpos/ee/Constants.tmp"
      tofile="${build.src}/org/jpos/ee/Constants.properties"
      filtering="true" />
  <delete file="${build.src}/org/jpos/ee/Constants.tmp" />
 </target>
</project>

